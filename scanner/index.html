<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scanner cave</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="container">
    <h1>Scanner</h1>

    <div class="card">
      <label class="label">Code-barres (EAN)</label>
      <input id="ean" class="input" placeholder="Ex : 3215190004173" inputmode="numeric" />

      <div class="buttons">
        <button id="btnLookup" class="btn primary">Chercher</button>
        <button id="btnScan" class="btn secondary">Scanner (caméra)</button>
      </div>

      <div id="status" class="status">Prêt</div>
    </div>

    <div id="result" class="card hidden"></div>

    <!-- Formulaire si vin inconnu -->
    <div id="form" class="card hidden">
      <h2>Compléter la fiche</h2>

      <label class="label">Nom</label>
      <input id="f_nom" class="input" />

      <label class="label">Domaine</label>
      <input id="f_domaine" class="input" />

      <label class="label">Appellation</label>
      <input id="f_appellation" class="input" />

      <label class="label">Millésime</label>
      <input id="f_millesime" class="input" placeholder="NV si non applicable" />

      <label class="label">Couleur</label>
      <select id="f_couleur" class="input">
        <option value="">—</option>
        <option value="rouge">Rouge</option>
        <option value="blanc">Blanc</option>
        <option value="rose">Rosé</option>
        <option value="champagne">Champagne / effervescent</option>
      </select>

      <label class="label">Format</label>
      <input id="f_format" class="input" placeholder="75cl" />

      <label class="label">Emplacement</label>
      <input id="f_emplacement" class="input" placeholder="Ex : Cave A / Étage 2" />

      <div class="buttons">
        <button id="btnUpsert" class="btn primary">Enregistrer la fiche</button>
      </div>
    </div>

    <!-- Caméra Quagga -->
    <div id="cameraWrap" class="camera hidden">
      <div class="cameraHeader">
        <div>Scanner le code-barres</div>
        <button id="btnStop" class="btn danger small">Stop</button>
      </div>
      <div id="scannerViewport" class="viewport"></div>
      <div class="hint">
        Placez le code-barres bien à plat, proche de la caméra, avec une bonne lumière.
      </div>
    </div>
  </main>

  <!-- QuaggaJS (CDN) -->
  <script src="https://unpkg.com/quagga@0.12.1/dist/quagga.min.js"></script>

  <!-- Votre JS (gardez éventuellement ?v=...) -->
  <script src="app.js?v=1"></script>
</body>
</html>
